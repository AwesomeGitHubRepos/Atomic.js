!function(t){var i={};function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)e.d(s,n,function(i){return t[i]}.bind(null,n));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=8)}([function(t,i){function e(t,i){this.x=t||0,this.y=i||0}e.dist=function(t,i){return t.dist(i)},e.sub=function(t,i){return new e(t.x-i.x,t.y-i.y)},e.add=function(t,i){return new e(t.x+i.x,t.y+i.y)},e.fromAngle=function(t){let i=new e(0,0);return i.x=Math.cos(t),i.y=Math.sin(t),i},e.random2D=function(t){return e.fromAngle(Math.random()*Math.PI*180)},e.prototype={set:function(t,i){return this.x=t,this.y=i,this},add:function(t,i){return 1===arguments.length?(this.x+=t.x,this.y+=t.y):2===arguments.length&&(this.x+=t,this.y+=i),this},sub:function(t,i){return t instanceof e?(this.x-=t.x,this.y-=t.y):(this.x-=t,this.y-=i),this},sub2:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},mult:function(t){return"number"==typeof t?(this.x*=t,this.y*=t):(this.x*=t.x,this.y*=t.y),this},div:function(t){return"number"==typeof t?(this.x/=t,this.y/=t):(this.x/=t.x,this.y/=t.y),this},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},magSq:function(){return this.x*this.x+this.y*this.y},setMag:function(t){return this.normalize(),this.mult(t),this},normalize:function(){let t=this.mag();return t>0&&this.div(t),this},limit:function(t){return this.mag()>t&&(this.normalize(),this.mult(t)),this},heading:function(){return-Math.atan2(-this.y,this.x)},dist:function(t){let i=this.x-t.x,e=this.y-t.y;return Math.sqrt(i*i+e*e)},copy:function(){return new e(this.x,this.y)},negative:function(){return this.x=-this.x,this.y=-this.y,this},array:function(){return[this.x,this.y]},toString:function(){return"["+this.x+", "+this.y+", "+this.z+"]"},unit:function(){return this.div(this.mag())},subtract:function(t){return new e(this.x-t,this.y-t)},dot:function(t){return this.x*t.x+this.y*t.y},scale:function(t,i){return this.x=t.x*i,this.y=t.y*i,this},normal:function(t,i){var e=t.y-i.y,s=i.x-t.x,n=1/Math.sqrt(e*e+s*s);return this.x=e*n,this.y=s*n,this},copy:function(t){return this.x=t.x,this.y=t.y,this},squareDist:function(t){var i=this.x-t.x,e=this.y-t.y;return i*i+e*e},perp:function(t){return this.x=-t.y,this.y=t.x,this}},t.exports=e},function(t,i,e){const s=e(0);function n(t,i,e,n){this.opt=n,this.parent=t,this.position=new s(i.x,i.y),this.oldPosition=new s(i.x,i.y),this.pinned=e}n.prototype.integrate=function(){if(!this.pinned){let t=this.position,i=this.oldPosition,e=t.x,s=t.y;t.x+=(t.x-i.x)*this.opt.friction,t.y+=(t.y-i.y)*this.opt.friction+this.opt.gravity,i.set(e,s)}},n.prototype.boundary=function(){let t=this.position,i=this.oldPosition,e=t.x-i.x;t.y,i.y;t.y<0?t.y=0:t.y>this.opt.canvas.height&&(t.x-=(t.y-this.opt.canvas.height)*e*this.opt.groundFriction,t.y=this.opt.canvas.height),t.x<0?t.x=0:t.x>this.opt.canvas.width&&(t.x=this.opt.canvas.width)},t.exports=n},function(t,i){function e(t,i,e,s){this.parent=t,this.v0=i,this.v1=e,this.p0=i.position,this.p1=e.position,this.edge=s,this.dist=Math.sqrt(this.p0.squareDist(this.p1))}e.prototype.solve=function(){let t=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,e=Math.sqrt(t*t+i*i);const s=(e-this.dist)/e,n=.5*t*s,o=.5*i*s;this.p0.x+=n,this.p0.y+=o,this.p1.x-=n,this.p1.y-=o},t.exports=e},function(t,i,e){const s=e(0);function n(){this.testAxis=new s(0,0),this.response=new s(0,0),this.relTanVel=new s(0,0),this.tangent=new s(0,0),this.relVel=new s(0,0),this.center=new s(0,0),this.axis=new s(0,0),this.line=new s(0,0),this.depth=0,this.edge=null,this.vertex=null}n.prototype.SAT=function(t,i){this.checkAABB(i,t);let e=Number.MAX_SAFE_INTEGER;const s=t.edges.length;for(let n=0,o=s+i.edges.length;n<o;n++){let o=n<s?t.edges[n]:i.edges[n-s];this.testAxis.normal(o.p0,o.p1),t.project(this.testAxis),i.project(this.testAxis);const h=t.min<i.min?i.min-t.max:t.min-i.max;if(h>0)return!1;Math.abs(h)<e&&(e=Math.abs(h),this.axis.copy(this.testAxis),this.edge=o)}if(this.depth=e,this.edge.parent!=i){const e=i;i=t,t=e}const n=t.center.x-i.center.x,o=t.center.y-i.center.y;this.axis.x*n+this.axis.y*o<0&&this.axis.negative();let h,r,l=Number.MAX_SAFE_INTEGER;for(let e=0;e<t.vCount;e++)h=t.vertices[e],this.line.sub2(h.position,i.center),(r=this.axis.dot(this.line))<l&&(l=r,this.vertex=h);return!0},n.prototype.checkAABB=function(t,i){if(!(0>Math.abs(t.center.x-i.center.x)-(t.halfEx.x+i.halfEx.x)&&0>Math.abs(t.center.y-i.center.y)-(t.halfEx.y+i.halfEx.y)))return!1},n.prototype.resolve=function(t){let i=this.edge.p0,e=this.edge.p1,s=this.edge.v0.oldPosition,n=this.edge.v1.oldPosition,o=this.vertex.position,h=this.vertex.oldPosition,r=this.response;this.response.scale(this.axis,this.depth);let l=Math.abs(i.x-e.x)>Math.abs(i.y-e.y)?(o.x-r.x-i.x)/(e.x-i.x):(o.y-r.y-i.y)/(e.y-i.y),c=1/(l*l+(1-l)*(1-l)),a=this.vertex.parent.mass,f=this.edge.parent.mass,p=a+f;a/=p,f/=p,i.x-=r.x*(1-l)*c*a,i.y-=r.y*(1-l)*c*a,e.x-=r.x*l*c*a,e.y-=r.y*l*c*a,o.x+=r.x*f,o.y+=r.y*f,this.relVel.set(o.x-h.x-.5*(i.x+e.x-s.x-n.x),o.y-h.y-.5*(i.y+e.y-s.y-n.y)),this.tangent.perp(this.axis);let x=this.relVel.dot(this.tangent),u=this.relTanVel.set(this.tangent.x*x,this.tangent.y*x);h.x+=.95*u.x*f,h.y+=.95*u.y*f,s.x-=u.x*(1-l)*.95*c*a,s.y-=u.y*(1-l)*.95*c*a,n.x-=u.x*l*.95*c*a,n.y-=u.y*l*.95*c*a},n.prototype.aabb=function(t,i){return t.bound.minX<=i.bound.maxX&&t.bound.minY<=i.bound.maxY&&t.bound.maxX>=i.bound.minX&&i.bound.maxY>=t.bound.minY},t.exports=n},function(t,i,e){const s=e(0),n=e(2),o=e(1);function h(t,i){if(this.vCount=0,this.eCount=0,this.min=0,this.max=0,this.vertices=[],this.positions=[],this.edges=[],this.bound={},this.center=new s(0,0),this.halfEx=new s(0,0),this.engine=i,this.render=t.render||{fillStyle:"black"},this.mass=void 0==t.mass?1:t.mass,this.static=t.static||!1,this.angle=t.angle||0,this.static&&(this.mass=Number.MAX_SAFE_INTEGER),"string"==typeof t.vertices){let i=t.vertices.split(" "),e={};for(let t=0;t<i.length;t++)e[t]={x:Number(i[t].split(",")[0]),y:Number(i[t].split(",")[1])};t.vertices=e}for(let i in t.vertices){let e=new o(this,t.vertices[i],this.static,{friction:this.engine.friction,gravity:this.engine.gravity,canvas:this.engine.canvas,groundFriction:this.engine.groundFriction});t.vertices[i].compiled=e,this.vertices.push(e),this.positions.push(e.position),this.engine.vertices.push(e),this.vCount++}for(let i=0;i<t.constraints.length;i++){let e=t.constraints[i],s=new n(this,t.vertices[e[0]].compiled,t.vertices[e[1]].compiled,e[2]||!1);s.edge&&(this.edges.push(s),this.eCount++),this.engine.constraints.push(s)}if(0!==this.angle)for(let t=0;t<this.vertices.length;t++){let i=this.angle/180*Math.PI;this.calculateCenter(),this.vertices[t].position.x=this.vertices[t].position.x*Math.cos(i)-this.vertices[t].position.y*Math.sin(i),this.vertices[t].position.y=this.vertices[t].position.x*Math.sin(i)+this.vertices[t].position.y*Math.cos(i),this.vertices[t].oldPosition.x=this.vertices[t].position.x,this.vertices[t].oldPosition.y=this.vertices[t].position.y}}h.prototype.calculateCenter=function(){let t=99999,i=99999,e=-99999,s=-99999;for(let n=0;n<this.vertices.length;n++){let o=this.positions[n];o.x>e&&(e=o.x),o.y>s&&(s=o.y),o.x<t&&(t=o.x),o.y<i&&(i=o.y)}this.center.set(.5*(t+e),.5*(i+s)),this.halfEx.set(.5*(e-t),.5*(s-i)),this.bound={minX:t,minY:i,maxX:e,maxY:s}},h.prototype.project=function(t){function i(t,i){return t.x*i.x+t.y*i.y}let e=i(this.vertices[0].position,t),s=max=e;for(let n=0;n<this.vertices.length;n++){(e=i(this.vertices[n].position,t))<s&&(s=e),e>max&&(max=e)}this.min=s,this.max=max},h.prototype.draw=function(){this.engine.ctx.beginPath();let t=this.edges[0].p0;for(let t in this.render)this.render.hasOwnProperty(t)&&(this.engine.ctx[t]=this.render[t]);this.engine.ctx.fillStyle=this.render.fillStyle,this.engine.ctx.moveTo(t.x,t.y);for(let i=1;i<this.edges.length;i++)t=this.edges[i].p0,this.engine.ctx.lineTo(t.x,t.y);this.render.strokeStyle&&this.engine.ctx.stroke(),this.engine.ctx.fill(),this.engine.ctx.closePath()},h.prototype.drag=function(){if(this.engine.pointer.isDown&&!this.engine.dragVertex&&this.engine.ctx.isPointInPath(this.engine.pointer.x,this.engine.pointer.y)){let t=99999;for(let i=0;i<this.engine.vertices.length;i++){let e=this.engine.vertices[i].position.squareDist(this.engine.pointer);e<t&&(this.engine.dragVertex=this.engine.vertices[i],t=e)}}!1===this.engine.pointer.isDown&&(this.engine.dragVertex=null)},t.exports=h},function(t,i){t.exports={self:null,create:function(t){return this.self=t,this},dots:function(t,i){let e=2*Math.PI,s=t||4;for(let t=0,n=this.self.vertices.length;t<n;t++){let n=this.self.vertices[t].position;if(!n.hidden){let t=n.color||i||"black";this.self.ctx.beginPath(),this.self.ctx.fillStyle=t,this.self.ctx.arc(n.x,n.y,s,0,e),this.self.ctx.fill(),this.self.ctx.closePath()}}},pointIndex:function(t,i){this.self.ctx.font=t||"10px Arial",this.self.ctx.fillStyle=i||"black";for(let t=0;t<this.self.vertices.length;t++){let i=this.self.vertices[t].position;this.self.ctx.fillText(t,i.x-5,i.y-5)}this.self.ctx.fill()},lines:function(t,i,e){if(e||(e=!1),this.self.constraints.length>0){this.self.ctx.beginPath(),this.self.ctx.strokeStyle=i||"black",this.self.ctx.lineWidth=t||1;for(let t=0;t<this.self.constraints.length;t++){let i=this.self.constraints[t];i.hidden||(this.self.ctx.moveTo(i.p0.x,i.p0.y),this.self.ctx.lineTo(i.p1.x,i.p1.y)),!0===e&&i.hidden&&(this.self.ctx.moveTo(i.p0.x,i.p0.y),this.self.ctx.lineTo(i.p1.x,i.p1.y))}this.self.ctx.stroke(),this.self.ctx.closePath()}},indexOfBodies:function(t,i){this.self.ctx.save(),this.self.ctx.font=t||"10px Arial",this.self.ctx.fillStyle=i||"black";for(let t=0;t<this.self.bodies.length;t++){let i=this.self.bodies[t];for(let e=0;e<i.vertices.length;e++){let s=i.vertices[e].position;this.self.ctx.fillText(t+"."+e,s.x-10,s.y-10)}}this.self.ctx.fill(),this.self.ctx.restore()},centerOfMass:function(t){this.self.ctx.fillStyle=t||"black",this.self.ctx.beginPath();for(let t=0;t<this.self.bodies.length;t++){let i=this.self.bodies[t];this.self.ctx.fillRect(i.center.x-2.5,i.center.y-2.5,5,5)}this.self.ctx.fill(),this.self.ctx.closePath()},boundingBox:function(t){this.self.ctx.fillStyle=t||"rgba(0,0,0,0.2)",this.self.ctx.beginPath();for(let t=0;t<this.self.bodies.length;t++){let i=this.self.bodies[t];this.self.ctx.fillRect(i.center.x-i.halfEx.x,i.center.y-i.halfEx.y,i.halfEx.x+i.halfEx.x,i.halfEx.y+i.halfEx.y)}this.self.ctx.fill(),this.self.ctx.closePath()},information:function(){let t="Objects : "+this.self.bodies.length,i="Vertices : "+this.self.vertices.length,e="Constraints : "+this.self.constraints.length;this.self.ctx.fillStyle="black",this.self.ctx.font="14px Arial",this.self.ctx.fillText(t,10,20),this.self.ctx.fillText(i,10,40),this.self.ctx.fillText(e,10,60)}}},function(t,i,e){const s=e(5),n=e(4),o=e(3),h=e(2),r=e(1);function l(t,i,e,h,r,l){this.canvas=document.querySelector(t),this.width=i||200,this.height=e||200,this.canvas.width=this.width,this.canvas.height=this.height,this.ctx=this.canvas.getContext("2d"),this.gravity=void 0===h?1:h,this.friction=void 0===r?.1:r,this.groundFriction=.1,this.simIteration=l||10,this.constraintIterations=1,this.collisionIteration=this.simIteration/2,this.bodies=[],this.vertices=[],this.constraints=[],this.collision=new o;const c=this;this.dragVertex=null,this.pointer={x:0,y:0,isDown:!1},this.canvas.addEventListener("mousedown",()=>c.pointer.isDown=!0),this.canvas.addEventListener("mouseup",()=>c.pointer.isDown=!1),this.canvas.addEventListener("mousemove",function(t){c.pointer.x=t.offsetX,c.pointer.y=t.offsetY}),this.Poly={box:function(t,i,e,s,o){var h=new n({mass:o.mass,angle:o.angle,static:o.static||!1,render:o.render,vertices:{n0:{x:t,y:i},n1:{x:t+e,y:i},n2:{x:t+e,y:i+s},n3:{x:t,y:i+s}},constraints:[["n0","n1",!0],["n1","n2",!0],["n2","n3",!0],["n3","n0",!0],["n0","n2"],["n3","n1"]]},c);return c.bodies.push(h),h},triangle:function(t,i,e,s,o){e/=2,s/=2;var h=new n({x:t,y:i,mass:o.mass,static:o.static||!1,render:o.render,vertices:{0:{x:t-e,y:i+s},1:{x:t,y:i-s},2:{x:t+e,y:i+s}},constraints:[[0,1,!0],[1,2,!0],[2,0,!0]]},c);return c.bodies.push(h),h},circle:function(t,i,e,s,o){let h={},r=[],l=0,a=0;for(let n=0;n<s;n++){l+=2*Math.PI/s;let o=Math.cos(l)*e,c=Math.sin(l)*e;h[n]={x:o+t,y:c+i},r.push([n,(n+(s-s/2+2))%s,!0]),r.push([n,(n+s-1)%s,!1]),a++}h[a]={x:t,y:i};for(let t=0;t<a;t++)r.push([t,a,!1]);var f=new n({x:t,y:i,mass:o.mass,static:o.static||!1,render:o.render,vertices:h,constraints:r},c);return c.bodies.push(f),f}},this.Render=s.create(this)}l.Body=n,l.Vertex=r,l.Constraint=h,l.prototype.addVertex=function(t,i,e){let s=new l.Vertex(this,{x:t,y:i},e,{friction:this.friction,gravity:this.gravity,canvas:this.canvas});this.vertices.push(s)},l.prototype.addConstraint=function(t,i,e){let s=new l.Constraint(this,this.vertices[t],this.vertices[i],e);this.constraints.push(s)},l.prototype.frame=function(t,i){this.clear(i),(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame)(t)},l.prototype.clear=function(t){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),t&&(this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height))},l.prototype.createPoly=function(t,i,e){void 0===e&&(e={});let s=new l.Body({mass:2===arguments.length?i.mass:e.mass,render:2===arguments.length?i.render:e.render,vertices:t,constraints:i||[]},this);if(2===arguments.length){for(let t=0;t<s.vertices.length;t++){let i=s.vertices,e=new l.Constraint(s,s.vertices[t],s.vertices[(t+1)%i.length],!0);s.edges.push(e),this.constraints.push(e),s.eCount++}s.calculateCenter();let t=new l.Vertex(s,s.center,!1,{friction:this.friction,gravity:this.gravity,canvas:this.canvas,groundFriction:this.groundFriction});s.vertices.push(t),s.positions.push(t.position),this.vertices.push(t),s.vCount++;for(let t=0;t<s.vertices.length-1;t++){let i=new l.Constraint(s,s.vertices[t],s.vertices[s.vertices.length-1],!1);s.edges.push(i),s.eCount++,this.constraints.push(i)}}return this.bodies.push(s),s},l.prototype.integrate=function(){for(let t=0;t<this.vertices.length;t++)this.vertices[t].integrate()},l.prototype.updateConstraints=function(){for(let t=0;t<this.constraints.length;t++)this.constraints[t].solve()},l.prototype.updateBoundary=function(){for(let t=0;t<this.vertices.length;t++)this.vertices[t].boundary()},l.prototype.updateCollision=function(){for(let t=0;t<this.bodies.length;t++)this.bodies[t].calculateCenter();for(let t=0;t<this.bodies.length-1;t++){let i=this.bodies[t];for(let e=t+1;e<this.bodies.length;e++){let t=this.bodies[e];this.collision.aabb(i,t)&&this.collision.SAT(i,t)&&this.collision.resolve(this.friction)}}},l.prototype.update=function(){this.integrate();for(let t=0;t<this.simIteration;t++){for(let t=0;t<this.constraintIterations;t++)this.updateBoundary(),this.updateConstraints();this.updateCollision()}},l.prototype.render=function(){for(let t=0;t<this.bodies.length;t++)this.bodies[t].draw(),this.bodies[t].drag()},l.prototype.drag=function(){if(this.dragVertex){this.ctx.beginPath(),this.ctx.moveTo(this.dragVertex.position.x,this.dragVertex.position.y),this.ctx.lineTo(this.pointer.x,this.pointer.y),this.ctx.strokeStyle="#000",this.ctx.stroke();var t=1*this.dragVertex.parent.mass;this.dragVertex.position.x+=(this.pointer.x-this.dragVertex.position.x)/t,this.dragVertex.position.y+=(this.pointer.y-this.dragVertex.position.y)/t}},l.prototype.fpsScope={fps:null,bar_vx:0,lastframe:null,fpsBars:[]},l.prototype.showFps=function(t){let i=void 0!==(t=t||{}).x?t.x:10,e=void 0!==t.y?t.y:10,s=void 0!==t.updateSpeed?t.updateSpeed:3,n=new Date;if(!this.fpsScope.lastframe)return this.fpsScope.lastframe=n.valueOf(),void(this.fpsScope.fps=0);let o=(n.valueOf()-this.fpsScope.lastframe)/1e3;n.valueOf(),this.fpsScope.lastframe;this.fpsScope.lastframe=n.valueOf(),this.fpsScope.bar_vx++,this.fpsScope.bar_vx>s&&(this.fpsScope.bar_vx=0),0===this.fpsScope.bar_vx&&(this.fpsScope.fps=(1/o).toFixed(1));let h=t.barsColor||"green";this.fpsScope.fps<40&&(h="orange"),this.fpsScope.fps<20&&(h="red"),this.fpsScope.fpsBars.push({x:i+this.fpsScope.bar_vx,y:this.fpsScope.fps/2,color:h}),this.fpsScope.fpsBars.length>87&&this.fpsScope.fpsBars.shift();let r=this.ctx;return function(){r.beginPath(),r.fillStyle=t.background||"white",r.strokeStyle="black",r.lineWidth=.5,r.fillRect(i-5,e-5,100,60),r.strokeRect(i-5,e-5,100,60),r.fill(),r.stroke(),r.fillStyle=t.fontColor||"#555",r.font=t.font||"10px Arial",r.fillText("FPS : "+this.fpsScope.fps,i,e+10),r.save(),r.scale(1,-1);for(let t=0;t<this.fpsScope.fpsBars.length;t++)r.fillStyle=this.fpsScope.fpsBars[t].color,this.fpsScope.fpsBars[t].x+=1,r.fillRect(this.fpsScope.fpsBars[t].x-2,-50-e,1.2,this.fpsScope.fpsBars[t].y);r.restore(),r.strokeStyle="crimson",r.moveTo(i,e+20),r.lineTo(i+90,e+20),r.lineWidth=1,r.stroke(),r.closePath()}.call(this,null),this.fpsScope.fps},t.exports=l},function(t,i){var e;e=function(){return this}();try{e=e||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,i,e){(function(t){const i=e(6);t.Atomic=i}).call(this,e(7))}]);
//# sourceMappingURL=atomic.build.js.map